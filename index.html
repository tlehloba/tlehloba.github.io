<!DOCTYPE html>
<!-- cse6242 -->

<!-- run: http-server & -->

<head>
  <style>
 
  .bar > rect {
    display: inline-block;
    width: 10px;
    height: 75px;   /* We'll override height later */
    background-color: teal;
	margin-right: 2px;
}
   
  </style>
<html xmlns:mso="urn:schemas-microsoft-com:office:office" xmlns:msdt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882">
<!--[if gte mso 9]><xml>
<mso:CustomDocumentProperties>
<mso:xd_Signature msdt:dt="string"></mso:xd_Signature>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Editor msdt:dt="string">Hull, Matthew D</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Editor>
<mso:Order msdt:dt="string">772600.000000000</mso:Order>
<mso:ComplianceAssetId msdt:dt="string"></mso:ComplianceAssetId>
<mso:TemplateUrl msdt:dt="string"></mso:TemplateUrl>
<mso:xd_ProgID msdt:dt="string"></mso:xd_ProgID>
<mso:_ExtendedDescription msdt:dt="string"></mso:_ExtendedDescription>
<mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Author msdt:dt="string">Hull, Matthew D</mso:display_urn_x003a_schemas-microsoft-com_x003a_office_x003a_office_x0023_Author>
<mso:TriggerFlowInfo msdt:dt="string"></mso:TriggerFlowInfo>
<mso:ContentTypeId msdt:dt="string">0x0101008ED456B09E29044F8DC06CE1A56FBBB8</mso:ContentTypeId>
<mso:_SourceUrl msdt:dt="string"></mso:_SourceUrl>
<mso:_SharedFileIndex msdt:dt="string"></mso:_SharedFileIndex>
<mso:MediaLengthInSeconds msdt:dt="string"></mso:MediaLengthInSeconds>
</mso:CustomDocumentProperties>
</xml><![endif]-->
<title>Running Total of TMDb Movies by Year</title>
</head>

<body>

  <script src="lib/d3/d3.min.js"></script>
  <script src="lib/d3-dsv/d3-dsv.min.js"></script>
  <script src="lib/d3-fetch/d3-fetch.min.js"></script>


  <script>
    // define the dimensions and margins for the graph
	var margin = {top: 200, right: 20, bottom: 100, left: 80},
		 width = 960 - margin.left - margin.right,
		 height = 500 - margin.top - margin.bottom;
		 
	var padding = 6;
	var w=10;

    // define function to parse time in years format
	var formatTime = d3.timeParse("%Y");
	

    // create scales x & y for X and Y axis and set their ranges
		var x = d3.scaleTime().range([0, width-margin.left-margin.right]);
		var y = d3.scaleLinear().range([height, 0]);


    // append svg element to the body of the page
    // set dimensions and position of the svg element
    var svg = d3.select("body")
		.append("svg")
		.attr("id","container")
		.attr("width", width + margin.left + margin.right)
		.attr("height", height + margin.top + margin.bottom)
		.append("g")
		.attr("transform",
		"translate(" + margin.left + "," + margin.top + ")");
	


    // Get the data
	var pathToCsv = "q3.csv";		// path to csv
	
    d3.csv(pathToCsv).then(function (data) {
		  data.forEach(function(d){
			d.year = formatTime
			(d.year)
			 console.log(data);
		  });
      
      /* Create bar plot using data from csv */

      // set the domains of X and Y scales based on data
      x.domain(d3.extent(data, function (d) { return d.year; }));
	  y.domain([0, d3.max(data, (function (d) { return parseInt(d.running_total); }))]);



	  console.log("this is total:"+d3.max(data, function (d) { return d.running_total; }))
	  // y.domain([d3.min(data), d3.max(data)]).range([height - 50, 0]);

      // Add bars to svg - create new elements based on your data
      svg.selectAll("g")
		.data(data)
		.enter()
		.append("rect")
		.attr("id","bars")
		.attr("class", "bar")
		.attr("x", function (d) { return x(d.year); })
		.attr("width", (w - padding))
		.attr("y", function (d) { return y(d.running_total); })
		.attr("height", function (d) { return height - y(d.running_total); })
		.attr("fill", function(d) {
					return "rgb(0, 0, " + Math.round(d * 10) + ")";
			   });


		// Title
		svg.append("text")
			.attr("id","title")
			.attr("x", (width / 2))
			.attr("y", 0 - (margin.top / 2))
			.attr("text-anchor", "middle")
			.style("font-size", "18px")
			.text("Running Total of TMDb Movies by Year");
		
		//  X Axis
		svg.append("g")
			.attr("id", "x_axis")
			.attr("transform", "translate(0," + height + ")")
			.call(d3.axisBottom(x).ticks(d3.timeYear.every(10)));


		// Text label for X Axis
		svg.append("text")
			.attr("id", "x_axis_label")
			.attr("class", "x label")
			.attr("text-anchor", "end")
			.attr("x", (width/2))
			.attr("y", height + 50)
			.text("Year");
		

		//  Y Axis
		svg.append("g")
			.attr("id", "y_axis")
			.attr("transform","translate("+0+",0)")
			.call(d3.axisLeft(y));  ///

	      // Text label for Y axis
		    svg.append("text")
		    	.attr("id", "y_axis_label")
				.attr("class", "y label")
				.attr("text-anchor", "end")
				.attr("y", -70)
				.attr("dy", ".75em")
				.attr("transform", "rotate(-90)")
				.text("Running Total");

			//GT username
		svg.append("text")
		   .attr("id","credit")
		   .attr("class", "x label")
		   .attr("x", 250 + (width / 2))
		   .attr("y", 300 - (margin.bottom / 2))
		   .text("tlehloba3");


    }).catch(function (error) {
      console.log(error);
    });


  </script>

</body>
